CREATE VIEW dbo.results_survey_view AS
SELECT r.id                                              AS id,
       CAST(IIF(r.archive IS NULL, 0, r.archive) AS BIT) AS archive,
       r.archived                                        AS archived,
       r.banner_group_photo                              AS banner_group_photo,
       r.branch_id                                       AS branch_id,
       r.branch_items                                    AS branch_items,
       b.name                                            AS branch_name,
       r.branch_services                                 AS branch_services,
       r.distributed_materials                           AS distributed_materials,
       r.event_category_id                               AS event_category_id,
       c.title                                           AS event_category_title,
       e.branch_id                                       AS event_proposal_branch_id,
       e.branch_name                                     AS event_proposal_branch_name,
       e.event_category_id                               AS event_proposal_category_id,
       r.event_proposal_id                               AS event_proposal_id,
       e.is_internal                                     AS event_proposal_is_internal,
       e.location_id                                     AS event_proposal_location_id,
       e.is_private                                      AS event_proposal_is_private,
       e.partner_organization_id                         AS event_proposal_partner_organization_id,
       e.proposed_date                                   AS event_proposal_proposed_date,
       e.proposed_time                                   AS event_proposal_proposed_time,
       e.proposed_end_date                               AS event_proposal_proposed_end_date,
       e.proposed_end_time                               AS event_proposal_proposed_end_time,
       e.title                                           AS event_proposal_title,
       e.event_type_id                                   AS event_proposal_type_id,
       r.event_type_id                                   AS event_type_id,
       t.title                                           AS event_type_title,
       r.event_video                                     AS event_video,
       r.finalized                                       AS finalized,
       r.fragrances                                      AS fragrances,
       r.fragrances_recorded                             AS fragrances_recorded,
       r.hidden                                          AS hidden,
       r.is_internal                                     AS is_internal,
       r.is_private                                      AS is_private,
       l.address                                         AS location_address,
       l.city                                            AS location_city,
       l.country_region                                  AS location_country_region,
       r.location_id                                     AS location_id,
       l.location_name                                   AS location_name,
       l.state_province                                  AS location_state_province,
       l.zip_postal_code                                 AS location_zip_postal_code,
       r.man_hours_per_volunteer                         AS man_hours_per_volunteer,
       r.media_attended                                  AS media_attended,
       r.media_name                                      AS media_name,
       r.new_donations                                   AS new_donations,
       r.new_members_added                               AS new_members_added,
       r.no_event_video_reason                           AS no_event_video_reason,
       r.no_vip_photo_reason                             AS no_vip_photo_reason,
       r.non_members                                     AS non_members,
       o.address                                         AS partner_organization_address,
       o.city                                            AS partner_organization_city,
       o.country_region                                  AS partner_organization_country_region,
       r.partner_organization_id                         AS partner_organization_id,
       r.partner_organization_items                      AS partner_organization_items,
       r.partner_organization_services                   AS partner_organization_services,
       o.state_province                                  AS partner_organization_state_province,
       o.title                                           AS partner_organization_title,
       o.zip_postal_code                                 AS partner_organization_zip_postal_code,
       r.proposed_date                                   AS proposed_date,
       r.proposed_time                                   AS proposed_time,
       r.proposed_end_date                               AS proposed_end_date,
       r.proposed_end_time                               AS proposed_end_time,
       r.same_event_day                                  AS same_event_day,
       r.same_event_location                             AS same_event_location,
       r.same_event_partner_organization                 AS same_event_partner_organization,
       r.same_number_of_volunteers                       AS same_number_of_volunteers,
       r.title                                           AS title,
       r.vip_photos                                      AS vip_photos,
       r.volunteer_female_adults                         AS volunteer_female_adults,
       r.volunteer_male_adults                           AS volunteer_male_adults,
       r.volunteer_female_college_students               AS volunteer_female_college_students,
       r.volunteer_male_college_students                 AS volunteer_male_college_students,
       r.volunteer_female_teenagers                      AS volunteer_female_teenagers,
       r.volunteer_male_teenagers                        AS volunteer_male_teenagers,
       r.volunteer_female_young_adults                   AS volunteer_female_young_adults,
       r.volunteer_male_young_adults                     AS volunteer_male_young_adults,
       r.workflow_status                                 AS workflow_status,
       r.write_up                                        AS write_up,
       r.created_by                                      AS created_by,
       r.created_date                                    AS created_date,
       r.last_modified_by                                AS last_modified_by,
       r.last_modified_date                              AS last_modified_date,
       r.vistors                                         AS visitors,
       r.homes_helped                                    AS homes_helped,
       r.people_helped                                   AS people_helped,
       r.bags_of_trash                                   AS bags_of_trash,
       r.distance_cleaned_in_km                          AS distance_cleanced_in_km,
       r.weight_of_transh_cleaned                        AS weight_of_trash_cleaned,
       r.helped_addresses                                AS helped_addresses,
       r.beneficiaries_age_range                         AS beneficiaries_age_range,
       r.distance_cleaned_in_miles                       AS distance_cleanedInMiles,
       r.type_of_trees                                  AS type_of_tress,
       r.ounce_blood_collected                           AS ounce_blood_collected,
       r.volunteer_blood_donors                          AS volunteer_blood_donors,
       r.guest_blood_donors                              AS guest_blood_donors,
       r.maleapositive_blood                             AS male_a_positive_blood,
       r.maleanegative_blood                             AS male_a_negative_blood,
       r.malebpositive_blood                             AS male_b_positive_blood,
       r.malebnegative_blood                             AS male_b_negative_blood,
       r.maleopositive_blood                             AS male_o_positive_blood,
       r.maleonegative_blood                             AS male_o_negative_blood,
       r.maleabpositive_blood                            AS male_ab_positive_blood,
       r.maleabblood                                     AS male_ab_blood,
       r.femaleapositive_blood                           AS female_a_positive_blood,
       r.femaleanegative_blood                           AS female_a_negative_blood,
       r.femalebpositive_blood                           AS female_b_positive_blood,
       r.femalebnegative_blood                           AS female_b_negative_blood,
       r.femaleopositive_blood                           AS female_o_positive_blood,
       r.femaleonegative_blood                           AS female_o_negative_blood,
       r.femaleabpositive_blood                          AS female_ab_positive_blood,
       r.femaleabblood                                   AS female_ab_blood,
FROM dbo.results_survey r
       LEFT JOIN dbo.event_proposals e ON e.id = r.event_proposal_id
       LEFT JOIN dbo.locations l ON l.id = r.location_id
       LEFT JOIN dbo.organizations o ON o.id = r.partner_organization_id
       LEFT JOIN dbo.event_church_view b ON b.id = r.branch_id
       LEFT JOIN dbo.event_categories c ON c.id = r.event_category_id
       LEFT JOIN dbo.event_types t ON t.id = r.event_type_id
  go

create
unique
clustered index IDX_V1
    on dbo.results_survey_view (id)
go
